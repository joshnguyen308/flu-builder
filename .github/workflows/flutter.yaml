name: flutter app build

on: [push]
env:
  FLUTTER_VERSION: "2.10.0"
  GRADLE_VERSION: "7.5.1"

jobs:
  Flutter-Build:
    runs-on: ubuntu-latest
    steps:
    - name: echo github path 
      run: echo ${GITHUB_PATH}
    - name: update java repo 
      run: sudo apt-get update
    - name: install java jre
      run: sudo apt install openjdk-8-jre -y
    - name: install java jdk
      run: sudo apt install openjdk-8-jdk -y
    - name: install necessary packages
      run: sudo apt install apt-transport-https ca-certificates wget dirmngr gnupg software-properties-common unzip git wget -y
    - name: get flutter 
      run: wget https://storage.googleapis.com/flutter_infra_release/releases/stable/linux/flutter_linux_${FLUTTER_VERSION}-stable.tar.xz
    - name: get gradle 
      run: wget https://downloads.gradle-dn.com/distributions/gradle-${GRADLE_VERSION}-bin.zip
    - name: get commandlinetools
      run: wget https://dl.google.com/android/repository/commandlinetools-linux-8512546_latest.zipzip  
    - name: unzip files
      run: tar -xf flutter_linux_${FLUTTER_VERSION}-stable.tar.xz
    - name: add repo home variable
      run: echo "REPO_HOME=$(pwd)" >> $GITHUB_ENV
    - name: unzip gradle 
      run: unzip gradle-${GRADLE_VERSION}-bin.zip
    - name: unzip commandlinetools
      run: unzip commandlinetools-linux-8512546_latest.zip
    - name: export repo home to runner
      run: echo "${REPO_HOME}/flutter/bin" >> $GITHUB_PATH
    - name: ls -lha
      run: ls -lha
    - name: make android dir
      run: mkdir -p Android/cmdline-tools && mv cmdline-tools tools && mv tools Android/cmdline-tools
    - name: verify cmdline-tools
      run: ls -lha Android/cmdline-tools/tools
    - name: verify flutter
      run: flutter doctor
  


